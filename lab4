// === –ö–ª–∞—Å –ü—Ä–∞–∫—Ç–∏—á–Ω–µ –∑–∞–Ω—è—Ç—Ç—è ===
class PracticalLesson {
  String date;
  String topic;
  int studentCount;

  PracticalLesson(this.date, this.topic, this.studentCount);

  @override
  String toString() =>
      '–î–∞—Ç–∞: $date, –¢–µ–º–∞: "$topic", –°—Ç—É–¥–µ–Ω—Ç—ñ–≤: $studentCount';
}

// === Generic-–∫–ª–∞—Å –ù–∞–≤—á–∞–ª—å–Ω–∏–π –∫—É—Ä—Å<T> ===
class StudyCourse<T extends PracticalLesson> {
  String title;
  bool hasExam;
  Set<T> lessons = {};

  StudyCourse(this.title, this.hasExam);

  // –î–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–Ω—è—Ç—Ç—è (Generic –º–µ—Ç–æ–¥)
  void addLesson(T lesson) {
    lessons.add(lesson);
  }

  // Generic –º–µ—Ç–æ–¥ 1Ô∏è‚É£ ‚Äî —Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –±—É–¥—å-—è–∫–æ–≥–æ —á–∏—Å–ª–æ–≤–æ–≥–æ –ø–æ–ª—è
  double averageValue<R extends num>(R Function(T) getter) {
    if (lessons.isEmpty) return 0;
    var sum = lessons.fold<num>(0, (total, l) => total + getter(l));
    return sum / lessons.length;
  }

  // Generic –º–µ—Ç–æ–¥ 2Ô∏è‚É£ ‚Äî –ø–æ—à—É–∫ –º–∞–∫—Å–∏–º—É–º—É –∑–∞ –±—É–¥—å-—è–∫–∏–º –∫—Ä–∏—Ç–µ—Ä—ñ—î–º
  T? maxByCriterion<R extends Comparable>(R Function(T) getter) {
    if (lessons.isEmpty) return null;
    return lessons.reduce(
        (a, b) => getter(a).compareTo(getter(b)) >= 0 ? a : b);
  }

  // Generic –º–µ—Ç–æ–¥ 3Ô∏è‚É£ ‚Äî —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ –±—É–¥—å-—è–∫–æ—é —É–º–æ–≤–æ—é
  List<T> filter(bool Function(T) condition) {
    return lessons.where(condition).toList();
  }

  // –í–∏–≤—ñ–¥ —É—Å—ñ—Ö –∑–∞–Ω—è—Ç—å
  void showLessons() {
    print('–ó–∞–Ω—è—Ç—Ç—è –∫—É—Ä—Å—É "$title":');
    for (var l in lessons) {
      print('  - $l');
    }
    print('');
  }
}

// === main() ===
void main() {
  var course = StudyCourse<PracticalLesson>('–û—Å–Ω–æ–≤–∏ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è', true);

  // –î–æ–¥–∞—î–º–æ –∑–∞–Ω—è—Ç—Ç—è
  course.addLesson(PracticalLesson('2025-09-12', '–ê–ª–≥–æ—Ä–∏—Ç–º–∏ —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è', 25));
  course.addLesson(PracticalLesson('2025-09-19', '–†–æ–±–æ—Ç–∞ –∑ –∫–æ–ª–µ–∫—Ü—ñ—è–º–∏', 22));
  course.addLesson(PracticalLesson('2025-09-26', '–ê–Ω–∞–ª—ñ–∑ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤', 30));
  course.addLesson(PracticalLesson('2025-10-03', '–û—Å–Ω–æ–≤–∏ Dart', 28));

  // –í–∏–≤—ñ–¥ —É—Å—ñ—Ö –∑–∞–Ω—è—Ç—å
  course.showLessons();

  // üî∏ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è generic-–º–µ—Ç–æ–¥—ñ–≤
  print('–°–µ—Ä–µ–¥–Ω—è –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤: '
      '${course.averageValue((l) => l.studentCount).toStringAsFixed(2)}');

  var maxLesson = course.maxByCriterion((l) => l.studentCount);
  print('–ó–∞–Ω—è—Ç—Ç—è –∑ –Ω–∞–π–±—ñ–ª—å—à–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤: $maxLesson');

  var topicsWithWord = course
      .filter((l) => l.topic.toLowerCase().contains('–∞–ª–≥–æ—Ä–∏—Ç–º'))
      .map((l) => l.topic)
      .toList();
  print('–¢–µ–º–∏, —â–æ –º—ñ—Å—Ç—è—Ç—å —Å–ª–æ–≤–æ "–∞–ª–≥–æ—Ä–∏—Ç–º":');
  topicsWithWord.forEach((t) => print('  - $t'));
}
